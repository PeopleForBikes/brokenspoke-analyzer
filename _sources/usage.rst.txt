Usage
=====

.. _general:

General
-------

.. program:: bna

.. option:: bna [OPTIONS] COMMAND [OPTIONS] [ARGS]...

This section describes the options that can be added on the CLI to alter some
default behaviors of the commands.

.. note::

  The global "OPTIONS" must always be placed between `bna` and the command to
  execute.

Verbosity
^^^^^^^^^

The verbosity level can be adjusted by adding or removing `-v` flags.

- None  : Initial log level is WARNING.
- `-v`  : INFO
- `-vv` : DEBUG
- `-vvv`: TRACE

Example: start a BNA run with the log level set to "TRACE"::

  bna -vvv run arizona flagstaff

.. _prepare:

Prepare
-------

The ``prepare`` subcommand is in charge of collecting and preparing the files
required to run an analysis.

Usage
^^^^^

.. program:: bna

.. option:: bna prepare [OPTIONS] COUNTRY CITY [STATE] [OUTPUT_DIR]

- **COUNTRY**: the name of the country or a specific region available as an OSM
  dataset. See the :ref:`datasets` page for more information.
- **CITY**: the full name of the city (e.g "flagstaff", "san antonio"). It is
  case insensitive and must be quoted if there are spaces.
- **STATE**: Only useful for US cities. It may generate incorrect results when
  used for other countries.
- **OUTPUT_DIR**: the last parameter and is an optional path to indicate where
  to store the results on disk.

Optional flags
""""""""""""""

Optional flags are also available to customize the analysis for non-US cities:

- **--speed-limit**: override the default speed limit (in km/h)                                                       │
- **--block-size**: size of a synthetic block for non-US cities (in meters)                                           │
- **--block-population**: population of a synthetic block for non-US cities

.. note::

  These optional flags would simply be ignored if used for US cities.

Example: a US city::

  bna prepare usa flagstaff arizona
  # Or simpler
  bna prepare arizona flagstaff

Example: a non-US city::

  bna prepare spain valencia

  # With custom parameters
  bna prepare spain valencia --speed-limit 30 --block-size 1000 --block-population 200

Example: a non-US city with a specific region::

  bna prepare paris paris


Analyze
-------

The ``analyze`` subcommand will consume the artifacts being generated by the
``prepare`` subcommand and start an analysis.

Usage
^^^^^

.. program:: bna

.. option:: bna analyze [OPTIONS] STATE CITY_SHP PFB_OSM_FILE [OUTPUT_DIR]

- **STATE**: the full name of the state (e.g "arizona", "new mexico"). It is
  case insensitive and must be quoted if there are spaces.
- **CITY_SHP**: the shapefile repesenting the city boundaries.
- **PFB_OSM_FILE**: the OSM file representing the city.
- **OUTPUT_DIR**: is the last parameter and is an optional path to indicate where
  to store the results on disk.

Optional flags
""""""""""""""

- **--docker-image**: override the BNA Docker image

Example::

  bna analyze arizona flagstaff flagstaff.shp flagstaff-arizona.osm

Run
---

The ``run`` subcommand is a combination of ``prepare`` and ``analyze``.

The syntax is identical to the :ref:`prepare` command.

Usage
^^^^^

.. program:: bna

.. option:: bna run [OPTIONS] COUNTRY CITY [STATE] [OUTPUT_DIR]


Optional flags
""""""""""""""

- **--docker-image**: override the BNA Docker image

Example::

  bna run arizona flagstaff

